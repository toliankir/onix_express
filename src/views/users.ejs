<!DOCTYPE html>
<html lang="en">
<%- include('header') %>

<body>
    <div class="container pt-5">
        <% if (typeof error !== 'undefined') { %>
        <h5 class="text-danger"><%= error %></h5>
        <% } %>
        <% if (typeof msg !== 'undefined') { %>
            <h5 class="text-primary"><%= msg %></h5>
        <% } %>
        <div class="pb-4 text-right">
            <% if (typeof loggedUser !== 'undefined') { %>
                <%= loggedUser %><a href="/v1/auth/logout" class="ml-1 btn btn-warning">Logout</a>
            <% } else  {%>
                <a href="/v1/users/create" class="btn btn-primary">Create user</a>
                <a href="/v1/users/login" class="btn btn-primary">Login</a>
            <% } %>        
        </div>
        <h3>Users</h3>
        <a href="/v1/users/add" class="btn btn-success float-right">Add User</a>
        <table class="w-100 mx-auto">
            <thead>
                <tr>
                    <th class="px-4">E-Mail</th>
                    <th class="px-4">Full name</th>
                    <th class="px-4 text-center">Action</th>
                </tr>
            </thead>
            <tbody>
                <% users.forEach(user => { %>
                <tr>
                    <td class="px-4"><%= user.email %></td>
                    <td class="px-4"><%= user.fullName %></td>
                    <td class="px-4 text-center">
                        <a href="/v1/users/update/<%= user._id %>" class="btn btn-primary btn-sm">Edit</a>
                        <a href="/v1/users/delete/<%= user._id %>" class="btn btn-danger btn-sm">Delete</a>
                    </td>
                </tr>
                <% }); %>
            </tbody>
        </table>
    </div>
    <% if (typeof showAddModal !== 'undefined') { %>
        <%- include('modalAdd') %>
    <% } %>
    <% if (typeof showUpdateModal !== 'undefined') { %>
        <%- include('modalUpdate', { updatedUser }) %>
    <% } %>
    <% if (typeof showDeleteModal !== 'undefined') { %>
        <%- include('modalDelete', { deletedUser }) %>
    <% } %>
    <% if (typeof showLoginModal !== 'undefined') { %>
        <%- include('modalLogin') %>
    <% } %>
    <% if (typeof showCreateUser !== 'undefined') { %>
        <%- include('modalCreateSystemUser') %>
    <% } %>
</body>

</html>